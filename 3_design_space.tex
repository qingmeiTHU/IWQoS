%\section{A closer look at the quality issues}
\subsection{Design Space Insight}
The frame drop issue obviously violate the quality requirements, but naive solutions like increase video buffer violate the timeliness requirement. Thus, in our design, we keep video streaming buffer to be small to satisfy the timeliness requirement, and devise the frame generation and delivery mechanisms to improve video quality and adapt to variable network conditions. In our case, the first one is our choice. We limit the buffer size to $0.9s$, and the previous motivating example gives us three intuitions to improve the video streaming quality.

%To meet the delay constraints, there are two kinds of solution. One is to limit the timeliness of the sender buffer, i.e., strictly restrain each frame to meet the time requirements; the other may be controlled by scheduling to maintain the average of delay at the target value. Using this method, the largest end-to-end delay may be quite big. In our case, the first one is our choice. We limit the buffer size to $0.9s$. With buffer size limited, the previous motivating example gives us intuitions to redesign video frame generation and streaming in three levels.

\textbf{Reduce the dependency between frames.}
As non-key frames depend on keyframes and keyframes are independent, a naive approach is to reduce the keyframe interval. For example, if a 2-second interruption starts at the beginning of an 8-second GOP, the whole group are dropped; but if the 8-second GOP is refined to be four 2-second GOP, only one 2-second GOP would be dropped. Thus, the cascading effect would be eliminated. Nevertheless, this approach may be a tradeoff between the minimal frame drop and the video quality, because reducing keyframe interval means less compression in video streaming, to keep a pre-configured bitrate, per-image quality would be degraded (i.e., ``big pixels'').

We improve this approach by using streaming histories to find the optimal GOP size. We set up a target metric to measure the quality of the whole video, replay the video with historical network conditions, tune GOP size in each replay, and find out the GOP size with the best video quality. This computation can be done offline in cloud, CDN server, or in the streaming device, and the GOP size is configured as a parameter for next video streaming session.

%Another approach is to adapt the GOP selection to the network condition. In details, when the network recovers from an interruption, the first frame transmitted is encoded as I frame, and a new GOP restarts from this first frame. In this way, the new GOP has no dependency on previous (possible dropped) frames, and all its frames are decodable. This approach may need to modify the encoding workflow, which is hard and out of control.
\wenfei{check GOP and GoP, check figure and Figure}

\textbf{Drop frames wisely.} The default strategy in OBS is dropping all P/B frames in the buffer when exceeding a threshold. It is something reasonable because if dropping the earlier frames, the following frames cannot be decodable; and if dropping the latest several frames, the earlier frames still exist in the buffer. Therefore, the timeliness will be violated. But intuitively, dropping frames within the old GoP, rather than all, may have better performance. It is worth thinking how to design an online frame dropping strategy that approaches the optimal solution. The challenge lies in the complexity of the frame dependency. A brute force solution is impossible due to its time complexity.

\textbf{Adaptive bitrate.} Figure~\ref{fig:trace-all} shows network failures occur frequently, and measurements show that commercial applications only use constant bitrate(CBR) or ABR\wenfei{full name of this term} (i.e., the actual bitrate varies among the target value, at most $20\%$ lower or higher of the target bitrate. These two methods cannot follow the dynamic bandwidth, which would bring tremendous frame dropping when bandwidth falls down, especially in the case where the bandwidth drop lasts for a certain while. One possible solution is similar to DASH in VOD scenario, applying adaptive bitrate in broadcaster's side. In our case, the bitrate differs between two GoPs, which means we would decide a bitrate for each GoP. Introducing bitrate adaptation maybe dramatically cut down the frame dropping.

\iffalse
\begin{itemize}
\item If we can relax the dependency between frames, the solution space would be larger and more optimal solutions are expected to be found. That is, we can relax the decodability constraints to be $d_i = 1, \forall i$.

\item We can relax queue length constraint, i.e., making $T_1$ larger. This change similarly increases the space of possible solutions.

\item The frame drop strategy can be improved. That is, compared with the naive strategy in OBS (dropping all P/B when exceeding a threshold), selectively choosing frames to drop in IP would give a more optimal solution.
\end{itemize}
\fi

